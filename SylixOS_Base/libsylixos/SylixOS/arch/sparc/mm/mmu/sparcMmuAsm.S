;/*********************************************************************************************************
;**
;**                                    中国软件开源组织
;**
;**                                   嵌入式实时操作系统
;**
;**                                       SylixOS(TM)
;**
;**                               Copyright  All Rights Reserved
;**
;**--------------文件信息--------------------------------------------------------------------------------
;**
;** 文   件   名: sparcMmuAsm.S
;**
;** 创   建   人: Jiao.JinXing (焦进星)
;**
;** 文件创建日期: 2017 年 10 月 10 日
;**
;** 描        述: SPARC 体系构架 LEON 变种处理器 MMU 驱动.
;*********************************************************************************************************/

#ifndef ASSEMBLY
#define ASSEMBLY 1
#endif

#include <arch/assembler.h>
#include <config/kernel/vmm_cfg.h>

#if LW_CFG_VMM_EN > 0

    FILE_BEGIN()

    EXPORT_LABEL(leonMmuGetCtrlReg)
    EXPORT_LABEL(leonMmuSetCtrlReg)
    EXPORT_LABEL(leonMmuSetCtxTblPtr)
    EXPORT_LABEL(leonMmuSetCtx)
    EXPORT_LABEL(leonMmuGetCtx)
    EXPORT_LABEL(leonMmuGetFaultStatus)
    EXPORT_LABEL(leonMmuGetFaultAddr)

;/*********************************************************************************************************
;  获得控制寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuGetCtrlReg)
    LDA     [%g0] ASI_LEON_MMUREGS , %o0
    RETL
    NOP
    FUNC_END(leonMmuGetCtrlReg)

;/*********************************************************************************************************
;  设置控制寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuSetCtrlReg)
    STA     %o0 , [%g0] ASI_LEON_MMUREGS
    RETL
    NOP
    FUNC_END(leonMmuSetCtrlReg)

;/*********************************************************************************************************
;  设置上下文表指针寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuSetCtxTblPtr)
    MOV     LEON_CNR_CTXP , %g1
    STA     %o0 , [%g1] ASI_LEON_MMUREGS
    RETL
    NOP
    FUNC_END(leonMmuSetCtxTblPtr)

;/*********************************************************************************************************
;  设置上下文寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuSetCtx)
    MOV     LEON_CNR_CTX , %g1
    STA     %o0 , [%g1] ASI_LEON_MMUREGS
    RETL
    NOP
    FUNC_END(leonMmuSetCtx)

;/*********************************************************************************************************
;  获得上下文寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuGetCtx)
    MOV     LEON_CNR_CTX , %o0
    LDA     [%o0] ASI_LEON_MMUREGS , %o0
    RETL
    NOP
    FUNC_END(leonMmuGetCtx)

;/*********************************************************************************************************
;  获得错误状态寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuGetFaultStatus)
    MOV     LEON_CNR_F , %o0
    LDA     [%o0] ASI_LEON_MMUREGS , %o0
    RETL
    NOP
    FUNC_END(leonMmuGetFaultStatus)

;/*********************************************************************************************************
;  获得错误地址寄存器
;*********************************************************************************************************/

FUNC_DEF(leonMmuGetFaultAddr)
    MOV     LEON_CNR_FADDR , %o0
    LDA     [%o0] ASI_LEON_MMUREGS , %o0
    RETL
    NOP
    FUNC_END(leonMmuGetFaultAddr)

    FILE_END()

#endif
;/*********************************************************************************************************
;  END
;*********************************************************************************************************/
